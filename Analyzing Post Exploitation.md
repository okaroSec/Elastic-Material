

## Understanding Common Post-Exploitation Techniques

Post-exploitation activities can vary widely but often include steps to gather more information about the compromised system and network, establish persistence, and expand control. Recognizing the signs of these activities is the first step in responding to an attack.

- **Command Execution for Reconnaissance**: Attackers often run specific commands to gather information about the system's security measures, such as antivirus software and the network's configuration. For instance, commands that check for antivirus might involve querying system services or registry keys associated with security software.
    
- **Unauthorized Account Changes**: The creation of new user accounts or modification of existing ones can provide attackers with persistent access to a compromised system. Monitoring for commands related to user account manipulation is crucial for detecting and mitigating unauthorized access.
    
- **File Movements**: Moving files, especially malicious ones, to different directories can help attackers avoid detection and set them up for further exploitation. Tracking file movements is essential for understanding the scope of an intrusion and preventing further damage.

## Analyzing Sysmon Logs

Sysmon provides detailed logging of system activity, making it invaluable for post-exploitation analysis. By examining Sysmon logs, we can uncover evidence of malicious activity that might otherwise go unnoticed.

- **Detecting Reconnaissance Commands**: By filtering Sysmon event logs for process creation (event ID '1') using query  `winlog.provider_name:"Microsoft-Windows-Sysmon" and winlog.event_id:"1"` and focusing on commands executed from `cmd.exe` using `winlog.event_data.ParentImage: cmd.exe`, we can identify potential reconnaissance efforts. For example, commands that list antivirus software or network configurations can reveal an attacker's attempts to understand and navigate the environment.  
     
- **Identifying Unauthorized User Account Changes**: Commands that add or modify user accounts are red flags for post-exploitation activity. By examining processes spawned from `cmd.exe` that involve user account manipulation, we can detect and respond to unauthorized access.  
     
- **Tracing File Movements and Execution**: Monitor file creation via Event ID '15', capturing file stream initiations and their hash values, especially targeting malware downloads marked by the "Zone.Identifier" stream. This aids in tracing malicious file paths while process creation events (Event ID '1') confirm execution, providing insights into attack deployment from compromised systems.